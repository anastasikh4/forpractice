<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English-Russian Vocabulary Games üéÉ</title>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Special+Elite&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Special Elite', cursive;
            background: linear-gradient(to bottom, #1a1a2e, #16213e, #0f3460);
            color: #f0f0f0;
            text-align: center;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
        }
        .spooky-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }
        h1 {
            font-family: 'Creepster', cursive;
            color: #ff5722;
            text-shadow: 0 0 10px #ff0000, 0 0 20px #ff5722;
            font-size: 48px;
            margin-bottom: 10px;
        }
        h2 {
            color: #ff9800;
            font-family: 'Creepster', cursive;
            font-size: 32px;
            text-shadow: 0 0 5px #ff5722;
        }
        button {
            background-color: #8b0000;
            color: #ffcc00;
            border: none;
            padding: 12px 24px;
            margin: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'Special Elite', cursive;
            transition: all 0.3s;
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.5);
            border: 1px solid #ff5722;
        }
        button:hover {
            background-color: #b22222;
            box-shadow: 0 0 15px rgba(255, 87, 34, 0.8);
            transform: scale(1.05);
        }
        textarea {
            width: 80%;
            max-width: 600px;
            height: 100px;
            margin: 20px;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #ff5722;
            background-color: #2c2c54;
            color: #f0f0f0;
            font-family: 'Special Elite', cursive;
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);
        }
        .game-container {
            margin: 20px auto;
            max-width: 800px;
            background-color: rgba(44, 44, 84, 0.8);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 87, 34, 0.3);
            border: 2px solid #ff5722;
        }
        .wordsearch-grid {
            display: grid;
            grid-template-columns: repeat(10, 30px);
            gap: 5px;
            margin: 20px auto;
        }
        .wordsearch-cell {
            width: 30px;
            height: 30px;
            background-color: #2c2c54;
            border: 1px solid #ff5722;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            color: #ffcc00;
        }
        .wordsearch-cell.selected {
            background-color: #8b0000;
            box-shadow: 0 0 5px #ff0000;
        }
        .snake {
            font-size: 24px;
            letter-spacing: 2px;
            background-color: #2c2c54;
            padding: 10px;
            border-radius: 10px;
            white-space: pre-wrap;
            word-break: break-all;
            color: #ffcc00;
            border: 1px solid #ff5722;
        }
        .anagram-letters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        .anagram-letter {
            background-color: #8b0000;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            color: #ffcc00;
            border: 1px solid #ff5722;
        }
        .anagram-letter.selected {
            background-color: #b22222;
            box-shadow: 0 0 10px #ff5722;
        }
        .result {
            font-size: 18px;
            margin-top: 10px;
            color: #ff5722;
            font-weight: bold;
        }
        .matching-column {
            display: inline-block;
            vertical-align: top;
            width: 45%;
            margin: 10px;
        }
        .matching-item {
            background-color: #2c2c54;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            color: #ffcc00;
            border: 1px solid #ff5722;
            transition: all 0.3s;
        }
        .matching-item.selected {
            background-color: #8b0000;
            box-shadow: 0 0 10px #ff5722;
        }
        .missing-letters input {
            width: 20px;
            text-align: center;
            border: 1px solid #ff5722;
            border-radius: 3px;
            background-color: #2c2c54;
            color: #ffcc00;
        }
        .tf-pair {
            margin: 10px;
            padding: 10px;
            background-color: #2c2c54;
            border-radius: 5px;
            border: 1px solid #ff5722;
        }
        .tf-button {
            margin: 5px;
        }
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 500px;
        }
        .memory-card {
            height: 80px;
            background-color: #8b0000;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            color: #ffcc00;
            border: 1px solid #ff5722;
            transition: all 0.3s;
        }
        .memory-card.flipped {
            background-color: #2c2c54;
        }
        .memory-card.matched {
            background-color: #4CAF50;
            cursor: default;
        }
        .crossword-grid {
            display: grid;
            grid-template-columns: repeat(8, 40px);
            gap: 2px;
            margin: 20px auto;
            justify-content: center;
        }
        .crossword-cell {
            width: 40px;
            height: 40px;
            background-color: #2c2c54;
            border: 1px solid #ff5722;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #ffcc00;
        }
        .crossword-cell.filled {
            background-color: #8b0000;
        }
        .crossword-cell input {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #ffcc00;
            text-transform: uppercase;
        }
        .hangman-figure {
            font-size: 80px;
            margin: 20px 0;
            line-height: 1.5;
            color: #ffcc00;
            min-height: 100px;
        }
        .hangman-word {
            font-size: 32px;
            letter-spacing: 10px;
            margin: 20px 0;
            color: #ffcc00;
        }
        .hangman-letters {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }
        .hangman-letter {
            width: 40px;
            height: 40px;
            margin: 5px;
            background-color: #2c2c54;
            border: 1px solid #ff5722;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            color: #ffcc00;
        }
        .hangman-letter.used {
            background-color: #8b0000;
            cursor: default;
        }
        .spelling-input {
            width: 200px;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            border: 1px solid #ff5722;
            background-color: #2c2c54;
            color: #ffcc00;
            font-size: 18px;
            text-align: center;
        }
        .instructions {
            color: #ffcc00;
            margin-bottom: 20px;
            font-size: 18px;
        }
        .pumpkin {
            color: #ff9800;
            text-shadow: 0 0 5px #ff5722;
        }
        .ghost {
            color: #f0f0f0;
            text-shadow: 0 0 5px #8b0000;
        }
        .bat {
            color: #333;
            text-shadow: 0 0 5px #8b0000;
        }
        @keyframes float {
            0% {
                top: -10%;
                transform: translateX(0) rotate(0deg);
            }
            25% {
                transform: translateX(-20px) rotate(5deg);
            }
            50% {
                transform: translateX(20px) rotate(-5deg);
            }
            100% {
                top: 110%;
                transform: translateX(0) rotate(0deg);
            }
        }
        .spooky-element {
            position: absolute;
            font-size: 30px;
            animation: float linear infinite;
            opacity: 0.7;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="spooky-container" id="spookyContainer"></div>
    <h1>English-Russian Vocabulary Games <span class="pumpkin">üéÉ</span><span class="ghost">üëª</span></h1>
    <p class="instructions">Enter words in the format: english - russian (one per line) <span class="bat">ü¶á</span></p>
    <textarea id="wordInput" placeholder="e.g. apple - —è–±–ª–æ–∫–æ\nbook - –∫–Ω–∏–≥–∞"></textarea>
    <br>
    <button onclick="loadWords()">Submit Words <span class="ghost">üëª</span></button>
    <div id="gameButtons" style="display: none;">
        <button onclick="startGame('translation')">Translation Matching <span class="pumpkin">üéÉ</span></button>
        <button onclick="startGame('truefalse')">True/False Translation <span class="ghost">üëª</span></button>
        <button onclick="startGame('wordsearch')">Word Search <span class="bat">ü¶á</span></button>
        <button onclick="startGame('missingLetters')">Write Missing Letters <span class="pumpkin">üéÉ</span></button>
        <button onclick="startGame('matching')">Match Beginnings and Endings <span class="ghost">üëª</span></button>
        <button onclick="startGame('wordsnake')">Find Words in Snake <span class="bat">ü¶á</span></button>
        <button onclick="startGame('anagram')">Collect Word from Letters <span class="pumpkin">üéÉ</span></button>
        <button onclick="startGame('memory')">Memory Match <span class="ghost">üëª</span></button>
        <button onclick="startGame('crossword')">Mini Crossword <span class="bat">ü¶á</span></button>
        <button onclick="startGame('hangman')">Hangman <span class="pumpkin">üéÉ</span></button>
        <button onclick="startGame('spelling')">Spelling Challenge <span class="ghost">üëª</span></button>
    </div>
    <div id="gameContainer" class="game-container" style="display: none;"></div>

    <script>
        let words = []; // Array of {eng: '', rus: ''}
        let currentAnagramIndex = 0;
        let currentHangmanIndex = 0;
        let currentCrosswordIndex = 0;

        function loadWords() {
            const input = document.getElementById('wordInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            words = lines.map(line => {
                const [eng, rus] = line.split(' - ').map(str => str.trim());
                return { eng, rus };
            }).filter(word => word.eng && word.rus);
            if (words.length > 0) {
                document.getElementById('gameButtons').style.display = 'block';
            } else {
                alert('Please enter at least one valid word pair in the format: english - russian');
            }
        }

        function startGame(type) {
            const container = document.getElementById('gameContainer');
            container.style.display = 'block';
            container.innerHTML = '';
            let selectedWords = getRandomWords(5); // Select 5 random words for each game

            switch (type) {
                case 'translation':
                    generateTranslationMatching(container, selectedWords);
                    break;
                case 'truefalse':
                    generateTrueFalse(container, selectedWords);
                    break;
                case 'wordsearch':
                    generateWordSearch(container, selectedWords);
                    break;
                case 'missingLetters':
                    generateMissingLetters(container, selectedWords);
                    break;
                case 'matching':
                    generateMatching(container, selectedWords);
                    break;
                case 'wordsnake':
                    generateWordSnake(container, selectedWords);
                    break;
                case 'anagram':
                    currentAnagramIndex = 0;
                    generateAnagram(container, selectedWords);
                    break;
                case 'memory':
                    generateMemoryGame(container, selectedWords);
                    break;
                case 'crossword':
                    currentCrosswordIndex = 0;
                    generateCrossword(container, selectedWords);
                    break;
                case 'hangman':
                    currentHangmanIndex = 0;
                    generateHangman(container, selectedWords);
                    break;
                case 'spelling':
                    generateSpellingChallenge(container, selectedWords);
                    break;
            }
        }

        function getRandomWords(count) {
            let shuffled = words.slice().sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        // 1. Translation Matching (replaced quiz)
        function generateTranslationMatching(container, selectedWords) {
            container.innerHTML = '<h2>Translation Matching <span class="pumpkin">üéÉ</span></h2><p class="instructions">Match English words to their Russian translations</p><div class="matching-column" id="english"></div><div class="matching-column" id="russian"></div><span id="matchResult" class="result"></span>';
            let pairs = selectedWords.map(word => ({ eng: word.eng, rus: word.rus }));
            let shuffledRus = pairs.map(p => p.rus).sort(() => 0.5 - Math.random());
            const engDiv = document.getElementById('english');
            const rusDiv = document.getElementById('russian');
            let selectedEng = null;
            pairs.forEach((pair, i) => {
                const engSpan = document.createElement('div');
                engSpan.className = 'matching-item';
                engSpan.textContent = pair.eng;
                engSpan.dataset.rus = pair.rus;
                engSpan.onclick = () => {
                    if (selectedEng) selectedEng.classList.remove('selected');
                    selectedEng = engSpan;
                    engSpan.classList.add('selected');
                };
                engDiv.appendChild(engSpan);
            });
            shuffledRus.forEach((rus, i) => {
                const rusSpan = document.createElement('div');
                rusSpan.className = 'matching-item';
                rusSpan.textContent = rus;
                rusSpan.onclick = () => {
                    if (selectedEng) {
                        const result = document.getElementById('matchResult');
                        if (selectedEng.dataset.rus === rus) {
                            result.textContent = 'Correct match!';
                            result.style.color = '#4CAF50';
                            selectedEng.style.display = 'none';
                            rusSpan.style.display = 'none';
                        } else {
                            result.textContent = 'Wrong match!';
                            result.style.color = '#f44336';
                        }
                        selectedEng.classList.remove('selected');
                        selectedEng = null;
                    }
                };
                rusDiv.appendChild(rusSpan);
            });
        }

        // New: True/False Translation
        function generateTrueFalse(container, selectedWords) {
            container.innerHTML = '<h2>True/False Translation <span class="ghost">üëª</span></h2><p class="instructions">Decide if the translation is true or false</p>';
            let tfPairs = selectedWords.map(word => ({ eng: word.eng, rus: word.rus, correct: true }));
            // Add incorrect pairs
            for (let i = 0; i < 5; i++) {
                const randomWord1 = selectedWords[Math.floor(Math.random() * selectedWords.length)];
                let randomWord2 = selectedWords[Math.floor(Math.random() * selectedWords.length)];
                while (randomWord2 === randomWord1) {
                    randomWord2 = selectedWords[Math.floor(Math.random() * selectedWords.length)];
                }
                tfPairs.push({ eng: randomWord1.eng, rus: randomWord2.rus, correct: false });
            }
            // Shuffle
            tfPairs = tfPairs.sort(() => 0.5 - Math.random()).slice(0, 5); // Limit to 5 for simplicity
            tfPairs.forEach((pair, index) => {
                const div = document.createElement('div');
                div.className = 'tf-pair';
                div.innerHTML = `<span>${pair.eng} - ${pair.rus}</span><br><button class="tf-button" onclick="checkTF(${index}, true)">True</button><button class="tf-button" onclick="checkTF(${index}, false)">False</button><span id="tfResult${index}" class="result"></span>`;
                container.appendChild(div);
            });
            window.checkTF = function(index, userChoice) {
                const pair = tfPairs[index];
                const correct = pair.correct === userChoice;
                const result = document.getElementById(`tfResult${index}`);
                result.textContent = correct ? 'Correct!' : 'Wrong!';
                result.style.color = correct ? '#4CAF50' : '#f44336';
            };
        }

        // 2. Word Search
        function generateWordSearch(container, selectedWords) {
            container.innerHTML = '<h2>Word Search <span class="bat">ü¶á</span></h2><p class="instructions">Find the English words in the grid</p><div id="wordsearchGrid" class="wordsearch-grid"></div><div id="wordList"></div>';
            const gridSize = 10;
            const grid = Array.from({length: gridSize}, () => Array(gridSize).fill(''));
            selectedWords.forEach((word, i) => {
                const row = Math.floor(Math.random() * gridSize);
                const startCol = Math.floor(Math.random() * (gridSize - word.eng.length));
                for (let j = 0; j < word.eng.length; j++) {
                    grid[row][startCol + j] = word.eng[j].toUpperCase();
                }
            });
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    if (!grid[i][j]) grid[i][j] = String.fromCharCode(65 + Math.floor(Math.random() * 26));
                }
            }
            const gridDiv = document.getElementById('wordsearchGrid');
            grid.forEach((row, rowIndex) => {
                row.forEach((cell, colIndex) => {
                    const span = document.createElement('span');
                    span.className = 'wordsearch-cell';
                    span.textContent = cell;
                    span.onclick = () => span.classList.toggle('selected');
                    gridDiv.appendChild(span);
                });
            });
            const listDiv = document.getElementById('wordList');
            listDiv.innerHTML = '<h3>Words to find:</h3>' + selectedWords.map(w => w.eng.toUpperCase()).join(', ');
        }

        // 3. Write Missing Letters
        function generateMissingLetters(container, selectedWords) {
            container.innerHTML = '<h2>Write Missing Letters <span class="pumpkin">üéÉ</span></h2><p class="instructions">Fill in the blanks for English words</p>';
            selectedWords.forEach((word, index) => {
                const missingWord = word.eng.split('').map((letter, i) => Math.random() < 0.3 ? '_' : letter).join('');
                const div = document.createElement('div');
                div.innerHTML = `<span>${word.rus}: </span><span class="missing-letters">${missingWord.split('').map(l => l === '_' ? '<input type="text" maxlength="1">' : l).join('')}</span><button onclick="checkMissing(${index})">Check</button><span id="result${index}" class="result"></span>`;
                container.appendChild(div);
            });
            window.checkMissing = function(index) {
                const inputs = document.querySelectorAll(`#gameContainer > div:nth-child(${index+1}) input`);
                const missingSpan = document.querySelector(`#gameContainer > div:nth-child(${index+1}) .missing-letters`);
                const missingWord = Array.from(missingSpan.childNodes).map(node => node.tagName === 'INPUT' ? '_' : node.textContent).join('');
                let filledWord = '';
                let inputIdx = 0;
                for (let char of missingWord) {
                    if (char === '_') {
                        filledWord += inputs[inputIdx++].value.toLowerCase();
                    } else {
                        filledWord += char.toLowerCase();
                    }
                }
                const correct = selectedWords[index].eng.toLowerCase();
                const result = document.getElementById(`result${index}`);
                result.textContent = filledWord === correct ? 'Correct!' : `Wrong! Correct is ${correct}`;
                result.style.color = filledWord === correct ? '#4CAF50' : '#f44336';
            };
        }

        // 4. Match Beginnings and Endings
        function generateMatching(container, selectedWords) {
            container.innerHTML = '<h2>Match Beginnings and Endings <span class="ghost">üëª</span></h2><p class="instructions">Match the parts of English words</p><div class="matching-column" id="beginnings"></div><div class="matching-column" id="endings"></div><span id="matchResult" class="result"></span>';
            let pairs = selectedWords.map(word => {
                const splitIndex = Math.floor(word.eng.length / 2);
                return { begin: word.eng.substring(0, splitIndex), end: word.eng.substring(splitIndex), full: word.eng };
            });
            let shuffledEnds = pairs.map(p => p.end).sort(() => 0.5 - Math.random());
            const beginsDiv = document.getElementById('beginnings');
            const endsDiv = document.getElementById('endings');
            let selectedBegin = null;
            pairs.forEach((pair, i) => {
                const beginSpan = document.createElement('div');
                beginSpan.className = 'matching-item';
                beginSpan.textContent = pair.begin;
                beginSpan.dataset.full = pair.full;
                beginSpan.onclick = () => {
                    if (selectedBegin) selectedBegin.classList.remove('selected');
                    selectedBegin = beginSpan;
                    beginSpan.classList.add('selected');
                };
                beginsDiv.appendChild(beginSpan);
            });
            shuffledEnds.forEach((end, i) => {
                const endSpan = document.createElement('div');
                endSpan.className = 'matching-item';
                endSpan.textContent = end;
                endSpan.onclick = () => {
                    if (selectedBegin) {
                        const full = selectedBegin.textContent + end;
                        const result = document.getElementById('matchResult');
                        if (selectedBegin.dataset.full === full) {
                            result.textContent = 'Correct match!';
                            result.style.color = '#4CAF50';
                            selectedBegin.style.display = 'none';
                            endSpan.style.display = 'none';
                        } else {
                            result.textContent = 'Wrong match!';
                            result.style.color = '#f44336';
                        }
                        selectedBegin.classList.remove('selected');
                        selectedBegin = null;
                    }
                };
                endsDiv.appendChild(endSpan);
            });
        }

        // 5. Find Words in Word Snake
        function generateWordSnake(container, selectedWords) {
            container.innerHTML = '<h2>Find Words in Snake <span class="bat">ü¶á</span></h2><p class="instructions">Find hidden English words in the letter snake. They are hidden one after another with some letters in between.</p><div class="snake" id="snake"></div><input type="text" id="guess"><button onclick="checkSnake()">Check</button><span id="snakeResult" class="result"></span>';
            const shuffledWords = selectedWords.slice().sort(() => 0.5 - Math.random());
            let snakeParts = [];
            let fillerLen = Math.floor(Math.random() * 4) + 1;
            let filler = Array(fillerLen).fill(0).map(() => String.fromCharCode(65 + Math.floor(Math.random() * 26))).join('');
            snakeParts.push(filler);
            shuffledWords.forEach((word, i) => {
                snakeParts.push(word.eng.toUpperCase());
                if (i < shuffledWords.length - 1) {
                    fillerLen = Math.floor(Math.random() * 4) + 1;
                    filler = Array(fillerLen).fill(0).map(() => String.fromCharCode(65 + Math.floor(Math.random() * 26))).join('');
                    snakeParts.push(filler);
                }
            });
            fillerLen = Math.floor(Math.random() * 4) + 1;
            filler = Array(fillerLen).fill(0).map(() => String.fromCharCode(65 + Math.floor(Math.random() * 26))).join('');
            snakeParts.push(filler);
            const snakeLetters = snakeParts.join('');
            document.getElementById('snake').textContent = snakeLetters;
            let found = [];
            window.checkSnake = function() {
                const guess = document.getElementById('guess').value.trim().toUpperCase();
                const result = document.getElementById('snakeResult');
                if (shuffledWords.some(w => w.eng.toUpperCase() === guess) && !found.includes(guess)) {
                    found.push(guess);
                    result.textContent = 'Found! ' + found.join(', ');
                    result.style.color = '#4CAF50';
                } else {
                    result.textContent = 'Not found or already found.';
                    result.style.color = '#f44336';
                }
                document.getElementById('guess').value = '';
            };
        }

        // 6. Collect Word from Letters (Anagram like Duolingo)
        function generateAnagram(container, selectedWords) {
            const word = selectedWords[currentAnagramIndex];
            container.innerHTML = '<h2>Collect Word from Letters <span class="pumpkin">üéÉ</span></h2><p class="instructions">Rearrange letters to form the English word for: ' + word.rus + '</p><div class="anagram-letters" id="letters"></div><div id="formedWord"></div><button onclick="checkAnagram()">Check</button><button onclick="nextAnagram()">Next Word</button><span id="anagramResult" class="result"></span>';
            let letters = word.eng.split('').sort(() => 0.5 - Math.random());
            const lettersDiv = document.getElementById('letters');
            const formedDiv = document.getElementById('formedWord');
            let selectedLetters = [];
            letters.forEach((letter, i) => {
                const span = document.createElement('span');
                span.className = 'anagram-letter';
                span.textContent = letter;
                span.dataset.index = i;
                span.onclick = () => {
                    if (span.classList.contains('selected')) {
                        span.classList.remove('selected');
                        selectedLetters = selectedLetters.filter(l => l.index !== i);
                        formedDiv.textContent = selectedLetters.map(l => l.letter).join('');
                    } else {
                        span.classList.add('selected');
                        selectedLetters.push({ letter, index: i });
                        formedDiv.textContent = selectedLetters.map(l => l.letter).join('');
                    }
                };
                lettersDiv.appendChild(span);
            });
            window.checkAnagram = function() {
                const formed = formedDiv.textContent.toLowerCase();
                const correct = word.eng.toLowerCase();
                const result = document.getElementById('anagramResult');
                result.textContent = formed === correct ? 'Correct!' : `Wrong! Correct is ${correct}`;
                result.style.color = formed === correct ? '#4CAF50' : '#f44336';
            };
            
            window.nextAnagram = function() {
                currentAnagramIndex = (currentAnagramIndex + 1) % selectedWords.length;
                generateAnagram(container, selectedWords);
            };
        }

        // 7. Memory Match Game
        function generateMemoryGame(container, selectedWords) {
            container.innerHTML = '<h2>Memory Match <span class="ghost">üëª</span></h2><p class="instructions">Find matching English-Russian pairs</p><div class="memory-grid" id="memoryGrid"></div><span id="memoryResult" class="result"></span>';
            
            // Create pairs of cards
            let cards = [];
            selectedWords.forEach(word => {
                cards.push({ text: word.eng, type: 'eng', match: word.rus });
                cards.push({ text: word.rus, type: 'rus', match: word.eng });
            });
            
            // Shuffle cards
            cards = cards.sort(() => 0.5 - Math.random());
            
            const grid = document.getElementById('memoryGrid');
            let flippedCards = [];
            let matchedPairs = 0;
            
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'memory-card';
                cardElement.dataset.index = index;
                cardElement.dataset.text = card.text;
                cardElement.dataset.type = card.type;
                cardElement.dataset.match = card.match;
                
                cardElement.onclick = function() {
                    if (flippedCards.length < 2 && !this.classList.contains('flipped') && !this.classList.contains('matched')) {
                        this.classList.add('flipped');
                        this.textContent = card.text;
                        flippedCards.push(this);
                        
                        if (flippedCards.length === 2) {
                            const card1 = flippedCards[0];
                            const card2 = flippedCards[1];
                            
                            // Check if they match
                            if ((card1.dataset.type === 'eng' && card2.dataset.type === 'rus' && 
                                 card1.dataset.text === card2.dataset.match) ||
                                (card2.dataset.type === 'eng' && card1.dataset.type === 'rus' && 
                                 card2.dataset.text === card1.dataset.match)) {
                                
                                // Match found
                                card1.classList.add('matched');
                                card2.classList.add('matched');
                                matchedPairs++;
                                
                                if (matchedPairs === selectedWords.length) {
                                    document.getElementById('memoryResult').textContent = 'Congratulations! You found all matches!';
                                    document.getElementById('memoryResult').style.color = '#4CAF50';
                                }
                            } else {
                                // No match, flip back after a delay
                                setTimeout(() => {
                                    card1.classList.remove('flipped');
                                    card2.classList.remove('flipped');
                                    card1.textContent = '';
                                    card2.textContent = '';
                                }, 1000);
                            }
                            
                            flippedCards = [];
                        }
                    }
                };
                
                grid.appendChild(cardElement);
            });
        }

        // 8. Mini Crossword
        function generateCrossword(container, selectedWords) {
            const word = selectedWords[currentCrosswordIndex];
            container.innerHTML = '<h2>Mini Crossword <span class="bat">ü¶á</span></h2><p class="instructions">Fill in the crossword based on the Russian clue</p><div class="crossword-grid" id="crosswordGrid"></div><button onclick="checkCrossword()">Check</button><button onclick="nextCrossword()">Next Word</button><span id="crosswordResult" class="result"></span>';
            
            // Simple 8x8 crossword with one word
            const gridSize = 8;
            const grid = Array.from({length: gridSize}, () => Array(gridSize).fill(''));
            
            // Place the word horizontally in the middle
            const wordLength = word.eng.length;
            const row = Math.floor(gridSize / 2);
            const startCol = Math.floor((gridSize - wordLength) / 2);
            
            // Create crossword grid
            const crosswordGrid = document.getElementById('crosswordGrid');
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'crossword-cell';
                    
                    // If this cell is part of the word, make it an input
                    if (i === row && j >= startCol && j < startCol + wordLength) {
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.maxLength = 1;
                        input.dataset.row = i;
                        input.dataset.col = j;
                        input.dataset.correct = word.eng[j - startCol].toUpperCase();
                        cell.appendChild(input);
                        cell.classList.add('filled');
                    }
                    
                    crosswordGrid.appendChild(cell);
                }
            }
            
            window.checkCrossword = function() {
                const inputs = document.querySelectorAll('.crossword-cell input');
                let allCorrect = true;
                
                inputs.forEach(input => {
                    const userValue = input.value.toUpperCase();
                    const correctValue = input.dataset.correct;
                    
                    if (userValue === correctValue) {
                        input.style.color = '#4CAF50';
                    } else {
                        input.style.color = '#f44336';
                        allCorrect = false;
                    }
                });
                
                const result = document.getElementById('crosswordResult');
                if (allCorrect) {
                    result.textContent = 'Congratulations! All letters are correct!';
                    result.style.color = '#4CAF50';
                } else {
                    result.textContent = 'Some letters are incorrect. Try again!';
                    result.style.color = '#f44336';
                }
            };
            
            window.nextCrossword = function() {
                currentCrosswordIndex = (currentCrosswordIndex + 1) % selectedWords.length;
                generateCrossword(container, selectedWords);
            };
        }

        // 9. Hangman
        function generateHangman(container, selectedWords) {
            const word = selectedWords[currentHangmanIndex];
            container.innerHTML = '<h2>Hangman <span class="pumpkin">üéÉ</span></h2><p class="instructions">Guess the English word for: ' + word.rus + '</p><div class="hangman-figure" id="hangmanFigure">üòä</div><div class="hangman-word" id="hangmanWord">' + '_ '.repeat(word.eng.length) + '</div><div class="hangman-letters" id="hangmanLetters"></div><button onclick="nextHangman()">Next Word</button><span id="hangmanResult" class="result"></span>';
            
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lettersDiv = document.getElementById('hangmanLetters');
            let guessedLetters = [];
            let wrongGuesses = 0;
            const maxWrongGuesses = 6;
            
            // Create letter buttons
            for (let letter of alphabet) {
                const letterBtn = document.createElement('div');
                letterBtn.className = 'hangman-letter';
                letterBtn.textContent = letter;
                letterBtn.onclick = function() {
                    if (!this.classList.contains('used')) {
                        this.classList.add('used');
                        guessedLetters.push(letter);
                        checkLetter(letter);
                    }
                };
                lettersDiv.appendChild(letterBtn);
            }
            
            function checkLetter(letter) {
                const wordUpper = word.eng.toUpperCase();
                const hangmanWord = document.getElementById('hangmanWord');
                let wordDisplay = hangmanWord.textContent.split(' ');
                
                if (wordUpper.includes(letter)) {
                    // Correct guess
                    for (let i = 0; i < wordUpper.length; i++) {
                        if (wordUpper[i] === letter) {
                            wordDisplay[i] = letter;
                        }
                    }
                    hangmanWord.textContent = wordDisplay.join(' ');
                    
                    // Check if word is complete
                    if (!wordDisplay.includes('_')) {
                        document.getElementById('hangmanResult').textContent = 'Congratulations! You won!';
                        document.getElementById('hangmanResult').style.color = '#4CAF50';
                    }
                } else {
                    // Wrong guess
                    wrongGuesses++;
                    updateHangmanFigure();
                    
                    if (wrongGuesses >= maxWrongGuesses) {
                        document.getElementById('hangmanResult').textContent = `Game Over! The word was: ${word.eng}`;
                        document.getElementById('hangmanResult').style.color = '#f44336';
                    }
                }
            }
            
            function updateHangmanFigure() {
                const figure = document.getElementById('hangmanFigure');
                const stages = [
                    'üòä', // 0 wrong guesses - Happy
                    'üòê', // 1 wrong guess - Neutral
                    'üò†', // 2 wrong guesses - Angry
                    'üò¢', // 3 wrong guesses - Crying
                    'ü§¢', // 4 wrong guesses - Nauseous
                    'ü§Æ', // 5 wrong guesses - Throwing up
                    'üíÄ'  // 6 wrong guesses - Dead
                ];
                figure.textContent = stages[wrongGuesses];
            }
            
            updateHangmanFigure();
            
            window.nextHangman = function() {
                currentHangmanIndex = (currentHangmanIndex + 1) % selectedWords.length;
                generateHangman(container, selectedWords);
            };
        }

        // 10. Spelling Challenge
        function generateSpellingChallenge(container, selectedWords) {
            container.innerHTML = '<h2>Spelling Challenge <span class="ghost">üëª</span></h2><p class="instructions">Spell the English word for the Russian translation</p><div id="spellingWord"></div><input type="text" class="spelling-input" id="spellingInput"><button onclick="checkSpelling()">Check</button><button onclick="nextSpelling()">Next Word</button><span id="spellingResult" class="result"></span>';
            
            let currentSpellingIndex = 0;
            const word = selectedWords[currentSpellingIndex];
            
            document.getElementById('spellingWord').textContent = word.rus;
            
            window.checkSpelling = function() {
                const input = document.getElementById('spellingInput').value.trim().toLowerCase();
                const result = document.getElementById('spellingResult');
                
                if (input === word.eng.toLowerCase()) {
                    result.textContent = 'Correct!';
                    result.style.color = '#4CAF50';
                } else {
                    result.textContent = `Wrong! The correct spelling is: ${word.eng}`;
                    result.style.color = '#f44336';
                }
            };
            
            window.nextSpelling = function() {
                currentSpellingIndex = (currentSpellingIndex + 1) % selectedWords.length;
                const nextWord = selectedWords[currentSpellingIndex];
                document.getElementById('spellingWord').textContent = nextWord.rus;
                document.getElementById('spellingInput').value = '';
                document.getElementById('spellingResult').textContent = '';
            };
        }

        function createSpookyElements() {
            const container = document.getElementById('spookyContainer');
            const elements = ['üéÉ', 'üëª', 'ü¶á', 'üíÄ', 'üï∑Ô∏è', 'üï∏Ô∏è', 'üßü', 'üßõ'];
            
            for (let i = 0; i < 20; i++) {
                const element = document.createElement('div');
                element.className = 'spooky-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = Math.random() * 100 + '%';
                element.style.animationDuration = (Math.random() * 15 + 15) + 's';
                element.style.animationDelay = Math.random() * 10 + 's';
                element.style.fontSize = (Math.random() * 25 + 20) + 'px';
                container.appendChild(element);
            }
        }

        createSpookyElements();
    </script>
</body>
</html>